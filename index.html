<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Network Playlist Player</title>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<style>
body{margin:0;background:#0a192f;color:#e0e6ed;font-family:'Segoe UI',sans-serif;}
header{background:#1e3799;padding:12px;text-align:center;font-weight:bold;font-size:1.3em;}
#video-container{width:90%;max-width:700px;margin:20px auto;position:relative;}
video{width:100%;border-radius:12px;background:#000;}
.loader{display:none;border:5px solid rgba(255,255,255,0.1);border-top:5px solid #00bfff;border-radius:50%;width:40px;height:40px;animation:spin 1s linear infinite;margin:20px auto;}
@keyframes spin{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}
#status{text-align:center;padding:6px 10px;background:#3498db;border-radius:4px;margin-top:10px;}
.main-container{max-width:1100px;margin:0 auto;padding:10px;}
.channel-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:12px;}
.channel-item{background:#0b2545;border:2px solid #1f6feb;border-radius:10px;text-align:center;padding:10px;cursor:pointer;transition:all 0.3s ease;position:relative;}
.channel-item:hover{transform:translateY(-5px);border-color:#2ecc71;box-shadow:0 0 10px #2ecc71;}
.channel-item.active{border-color:#e74c3c;box-shadow:0 0 15px #e74c3c;}
.play-icon{font-size:2em;color:#00bfff;display:block;margin-bottom:5px;}
.channel-name{font-size:0.9em;color:#ecf0f1;font-weight:bold;}
.live-badge{position:absolute;top:6px;right:8px;background:#e74c3c;color:white;padding:2px 6px;border-radius:4px;font-size:0.75em;font-weight:bold;animation:pulse 1.2s infinite;}
@keyframes pulse{0%{opacity:1;}50%{opacity:0.5;}100%{opacity:1;}}
</style>
</head>
<body>

<header>üì∫ Network Playlist Player</header>
<div id="video-container">
<video id="video" controls autoplay playsinline></video>
<div class="loader" id="loader"></div>
</div>
<div style="text-align:center;"><div id="status">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div></div>

<div class="main-container">
<div id="channel-list" class="channel-grid"></div>
</div>

<script>
// üîπ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ M3U playlist URL
const PLAYLIST_URL = "https://tnm3u.live/tv.m3u"; // ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶®‡¶ø‡¶ú‡ßá‡¶∞ ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï ‡¶¶‡¶ø‡¶®

let streams=[],currentHls=null,lastChannel=null;
const video=document.getElementById("video");
const loader=document.getElementById("loader");
const status=document.getElementById("status");

async function loadPlaylist(){
    status.textContent="üì° Playlist ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...";
    try{
        const res=await fetch(PLAYLIST_URL);
        const text=await res.text();
        parseM3U(text);
    }catch(e){console.error(e); status.textContent="‚ùå Playlist load ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•";}
}

function parseM3U(data){
    const lines=data.split("\n").map(l=>l.trim()).filter(l=>l.length>0);
    streams=[];
    let current=null;
    for(const line of lines){
        if(line.startsWith("#EXTINF:")){
            current={};
            const parts=line.split(",");
            current.name=parts[1]||"Unknown";
        } else if(current && !line.startsWith("#")){
            current.url=line;
            streams.push(current);
            current=null;
        }
    }
    displayStreams();
}

function displayStreams(){
    const list=document.getElementById("channel-list");
    list.innerHTML="";
    streams.forEach((ch,i)=>{
        const div=document.createElement("div");
        div.className="channel-item";
        div.innerHTML=`<span class='play-icon'>‚ñ∂Ô∏è</span><div class='channel-name'>${ch.name}</div><div class='live-badge'>LIVE üî¥</div>`;
        div.onclick=()=>playStream(ch.url,div);
        list.appendChild(div);
    });
    status.textContent="‚úÖ Playlist ‡¶≤‡ßã‡¶° ‡¶π‡ßü‡ßá‡¶õ‡ßá!";
    if(streams.length>0) playStream(streams[0],document.querySelector(".channel-item"));
}

function playStream(url,item){
    if(lastChannel) lastChannel.classList.remove("active");
    if(item) { item.classList.add("active"); lastChannel=item; }
    loader.style.display="block"; status.textContent="üîÑ ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...";
    
    if(Hls.isSupported()){
        if(currentHls) currentHls.destroy();
        currentHls=new Hls();
        currentHls.loadSource(url);
        currentHls.attachMedia(video);
        currentHls.on(Hls.Events.MANIFEST_PARSED,()=>video.play());
        currentHls.on(Hls.Events.ERROR,()=>{loader.style.display="none"; status.textContent="‚ùå Stream load failed";});
        video.onplaying=()=>{loader.style.display="none"; status.textContent="‚úÖ ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶ö‡¶≤‡¶õ‡ßá";}
        video.onwaiting=()=>{loader.style.display="block"; status.textContent="‚è≥ Buffering...";}
    } else if(video.canPlayType("application/vnd.apple.mpegurl")){ video.src=url; video.play();}
    else{loader.style.display="none"; status.textContent="‚ùå Browser does not support HLS";}
}

document.addEventListener("DOMContentLoaded",loadPlaylist);
</script>

</body>
</html>
